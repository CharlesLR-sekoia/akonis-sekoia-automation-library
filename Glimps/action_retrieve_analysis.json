{
  "name": "Retrieve analysis",
  "description": "Retrieve the analysis matching the given uuid",
  "uuid": "c8c8a939-fa7e-5e4f-a73e-a5ed97ab8613",
  "docker_parameters": "RetrieveAnalysis",
  "arguments": {
    "title": "GetAnalysisByUUIDArgument",
    "type": "object",
    "properties": {
      "uuid": {
        "title": "Uuid",
        "description": "uuid of analysis",
        "type": "string"
      }
    },
    "required": [
      "uuid"
    ]
  },
  "results": {
    "title": "AnalysisResponse",
    "type": "object",
    "properties": {
      "status": {
        "title": "Status",
        "description": "false means an error occured",
        "type": "boolean"
      },
      "special_status_code": {
        "title": "Special Status Code",
        "description": "special error code, 0 means no special case",
        "type": "integer"
      },
      "uuid": {
        "title": "Uuid",
        "description": "Unique analysis identifier",
        "type": "string"
      },
      "sha256": {
        "title": "Sha256",
        "description": "string hex encoded input file SHA256",
        "type": "string"
      },
      "sha1": {
        "title": "Sha1",
        "description": "string hex encoded input file SHA1",
        "type": "string"
      },
      "md5": {
        "title": "Md5",
        "description": "string hex encoded input file MD5",
        "type": "string"
      },
      "ssdeep": {
        "title": "Ssdeep",
        "description": "string input file SSDeep",
        "type": "string"
      },
      "is_malware": {
        "title": "Is Malware",
        "description": "analysis result, is a malware or not",
        "type": "boolean"
      },
      "score": {
        "title": "Score",
        "description": "highest score given by probes",
        "type": "integer"
      },
      "done": {
        "title": "Done",
        "description": "is analysis finished",
        "type": "boolean"
      },
      "timestamp": {
        "title": "Timestamp",
        "description": "timestamp of the start of analysis in milliseconds",
        "type": "integer"
      },
      "file_count": {
        "title": "File Count",
        "description": "amount of file in the submission (input + extracted)",
        "type": "integer"
      },
      "duration": {
        "title": "Duration",
        "description": "duration of the analysis in milliseconds",
        "type": "integer"
      },
      "filetype": {
        "title": "Filetype",
        "description": "type of the file",
        "type": "string"
      },
      "size": {
        "title": "Size",
        "description": "input file size (in bytes)",
        "type": "integer"
      },
      "sid": {
        "title": "Sid",
        "description": "analysis UUID handled by GLIMPS malware finder - expert\ncould be used to construct expert link like:\nhttps://gmalware.useddomain.glimps.re/expert/en/analysis/results/advanced/${SID}",
        "type": "string"
      },
      "token": {
        "title": "Token",
        "description": "token that can be used to view analysis result in expert view",
        "type": "string"
      },
      "error": {
        "title": "Error",
        "description": "error message if Status is false",
        "type": "string"
      },
      "errors": {
        "title": "Errors",
        "description": "error message by services",
        "type": "object",
        "additionalProperties": {
          "type": "string"
        }
      },
      "filenames": {
        "title": "Filenames",
        "description": "list of analysed filename",
        "type": "array",
        "items": {
          "type": "string"
        }
      },
      "malwares": {
        "title": "Malwares",
        "description": "list of malware names found in analysis",
        "type": "array",
        "items": {
          "type": "string"
        }
      },
      "files": {
        "title": "Files",
        "description": "array of submission files (input file and extracted sub-files)",
        "type": "array",
        "items": {
          "$ref": "#/definitions/FileResult"
        }
      },
      "threats": {
        "title": "Threats",
        "description": "Summary of threats found in submission. Each submission file reaching threshold score will add an entry. Entry keys are the SHA256 of files",
        "type": "object",
        "additionalProperties": {
          "$ref": "#/definitions/Threat"
        }
      }
    },
    "required": [
      "status",
      "special_status_code",
      "uuid",
      "sha256",
      "sha1",
      "md5",
      "ssdeep",
      "is_malware",
      "score",
      "done",
      "timestamp",
      "file_count",
      "duration",
      "filetype",
      "size"
    ],
    "definitions": {
      "AvResult": {
        "title": "AvResult",
        "type": "object",
        "properties": {
          "av": {
            "title": "Av",
            "type": "string"
          },
          "result": {
            "title": "Result",
            "type": "string"
          },
          "score": {
            "title": "Score",
            "type": "integer"
          }
        },
        "required": [
          "av",
          "result",
          "score"
        ]
      },
      "FileResult": {
        "title": "FileResult",
        "type": "object",
        "properties": {
          "sha256": {
            "title": "Sha256",
            "type": "string"
          },
          "sha1": {
            "title": "Sha1",
            "type": "string"
          },
          "md5": {
            "title": "Md5",
            "type": "string"
          },
          "magic": {
            "title": "Magic",
            "type": "string"
          },
          "size": {
            "title": "Size",
            "type": "integer"
          },
          "is_malware": {
            "title": "Is Malware",
            "type": "boolean"
          },
          "av_result": {
            "title": "Av Result",
            "type": "array",
            "items": {
              "$ref": "#/definitions/AvResult"
            }
          }
        },
        "required": [
          "sha256",
          "sha1",
          "md5",
          "magic",
          "size",
          "is_malware"
        ]
      },
      "Tag": {
        "title": "Tag",
        "type": "object",
        "properties": {
          "name": {
            "title": "Name",
            "type": "string"
          },
          "value": {
            "title": "Value",
            "type": "string"
          }
        },
        "required": [
          "name",
          "value"
        ]
      },
      "Threat": {
        "title": "Threat",
        "type": "object",
        "properties": {
          "filenames": {
            "title": "Filenames",
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "tags": {
            "title": "Tags",
            "type": "array",
            "items": {
              "$ref": "#/definitions/Tag"
            }
          },
          "score": {
            "title": "Score",
            "type": "integer"
          },
          "magic": {
            "title": "Magic",
            "type": "string"
          },
          "sha256": {
            "title": "Sha256",
            "type": "string"
          },
          "sha1": {
            "title": "Sha1",
            "type": "string"
          },
          "md5": {
            "title": "Md5",
            "type": "string"
          },
          "ssdeep": {
            "title": "Ssdeep",
            "type": "string"
          },
          "file_size": {
            "title": "File Size",
            "type": "integer"
          },
          "mime": {
            "title": "Mime",
            "type": "string"
          }
        },
        "required": [
          "filenames",
          "tags",
          "score",
          "magic",
          "sha256",
          "sha1",
          "md5",
          "ssdeep",
          "file_size",
          "mime"
        ]
      }
    }
  }
}